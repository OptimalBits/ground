<html>
<head>
  <meta charset="utf-8">
  <title>Mocha Tests</title>
  <link rel="stylesheet" href="https://raw.github.com/visionmedia/mocha/master/mocha.css" />
  <script src="https://raw.github.com/LearnBoost/expect.js/d2440da086bf8dc38c6085641f23b968a0f48b29/expect.js"></script>
  <script src="https://raw.github.com/visionmedia/mocha/1.6.0/mocha.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  
  <script type="text/javascript">
    curl = {
           baseUrl: '',
           paths: {
              'jquery': 'http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min',
              'underscore': 'https://raw.github.com/amdjs/underscore/master/underscore-min',
              'json2': 'json2' // for older IE versions
           },
           packages: {
             'ginger': {
                 path: '', // http://localhost:8080 (relative)
                 main: 'ginger',
                 lib: ''
             }
           }
       };
  </script>
  
  <script src="https://raw.github.com/cujojs/curl/dev/dist/curl-kitchen-sink/curl.js"></script>
  
  <script>
    mocha.setup('bdd')
  
    var socket = io.connect(location.protocol+'//'+location.host);
    socket.once('connect', function(){
      //$(function () {
        curl(['test/test_cache'], function(){ // Fails in IE 8
          curl(['test/test_promises', // IE ok
                'test/test_routes', // IE ok with remark
                'test/test_events', // IE ok
                'test/test_declare', // IE ok
                'test/test_base', // IE ok
                'test/test_models', // Offline tests in IE
                'test/test_collections', // Offline tests fails in IE
                ], function(){
            // We need to run this first.
            mocha
                .globals(['socket', 'jQuery*']) // acceptable globals
                .run()
          });
        });
        //})
    });
  </script>
</head>
<body>
  <div id="mocha"></div>
</body>
</html>
